<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alesha File Explorer</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #24292e;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .breadcrumb {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        .breadcrumb a {
            color: #007bff;
            text-decoration: none;
        }
        .file-list {
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .file-item {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
        }
        .file-item:last-child {
            border-bottom: none;
        }
        .file-item:hover {
            background-color: #f8f9fa;
        }
        .file-icon {
            margin-right: 10px;
            width: 24px;
            text-align: center;
        }
        .file-name {
            flex-grow: 1;
        }
        .file-size {
            color: #6c757d;
            font-size: 0.9em;
        }
        .folder {
            font-weight: bold;
            color: #0366d6;
        }
        .file {
            color: #24292e;
        }
        a {
            text-decoration: none;
            color: inherit;
        }
        a:hover {
            text-decoration: underline;
        }
        .loading {
            text-align: center;
            padding: 20px;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìÅ Alesha File Explorer</h1>
        <p>–§–∞–π–ª–æ–æ–±–º–µ–Ω–Ω–∏–∫ –Ω–∞ GitHub Pages</p>
    </div>

    <div class="breadcrumb" id="breadcrumb">
        <a href="#" onclick="navigateTo('')">–ì–ª–∞–≤–Ω–∞—è</a>
    </div>

    <div class="file-list" id="fileList">
        <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

    <script>
        // –¢–µ–∫—É—â–∏–π –ø—É—Ç—å
        let currentPath = '';

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ URL
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function navigateTo(path) {
            currentPath = path;
            updateBreadcrumb();
            loadDirectoryContents();
            // –û–±–Ω–æ–≤–ª—è–µ–º URL –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            const newUrl = window.location.origin + window.location.pathname + (path ? `?path=${encodeURIComponent(path)}` : '');
            window.history.pushState({ path }, '', newUrl);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö–ª–µ–±–Ω—ã—Ö –∫—Ä–æ—à–µ–∫
        function updateBreadcrumb() {
            const breadcrumb = document.getElementById('breadcrumb');
            let html = '<a href="#" onclick="navigateTo(\'\')">–ì–ª–∞–≤–Ω–∞—è</a>';
            
            if (currentPath) {
                const parts = currentPath.split('/').filter(part => part);
                let accumulatedPath = '';
                
                parts.forEach((part, index) => {
                    accumulatedPath += (accumulatedPath ? '/' : '') + part;
                    html += ` / <a href="#" onclick="navigateTo('${accumulatedPath}')">${part}</a>`;
                });
            }
            
            breadcrumb.innerHTML = html;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
        async function loadDirectoryContents() {
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '<div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>';
            
            try {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º GitHub API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
                const apiUrl = `https://api.github.com/repos/GeNLaSas-cell/Alesha/contents/${currentPath}`;
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏');
                }
                
                const contents = await response.json();
                
                if (contents.length === 0) {
                    fileList.innerHTML = '<div class="file-item">–ü–∞–ø–∫–∞ –ø—É—Å—Ç–∞</div>';
                    return;
                }
                
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º: —Å–Ω–∞—á–∞–ª–∞ –ø–∞–ø–∫–∏, –ø–æ—Ç–æ–º —Ñ–∞–π–ª—ã
                contents.sort((a, b) => {
                    if (a.type === b.type) {
                        return a.name.localeCompare(b.name);
                    }
                    return a.type === 'dir' ? -1 : 1;
                });
                
                let html = '';
                contents.forEach(item => {
                    const isDir = item.type === 'dir';
                    const icon = isDir ? 'üìÅ' : getFileIcon(item.name);
                    const size = isDir ? '' : `<span class="file-size">(${formatFileSize(item.size)})</span>`;
                    
                    html += `
                        <div class="file-item ${isDir ? 'folder' : 'file'}">
                            <span class="file-icon">${icon}</span>
                            <span class="file-name">
                                <a href="${isDir ? '#' : item.download_url}" ${isDir ? `onclick="navigateTo('${currentPath ? currentPath + '/' : ''}${item.name}')"` : 'target="_blank"'}>
                                    ${item.name}
                                </a>
                            </span>
                            <span class="file-size">${size}</span>
                        </div>
                    `;
                });
                
                fileList.innerHTML = html;
                
            } catch (error) {
                fileList.innerHTML = `<div class="file-item">–û—à–∏–±–∫–∞: ${error.message}</div>`;
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –¥–ª—è —Ñ–∞–π–ª–∞ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é
        function getFileIcon(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const icons = {
                'txt': 'üìÑ', 'pdf': 'üìï', 'doc': 'üìò', 'docx': 'üìò',
                'xls': 'üìó', 'xlsx': 'üìó', 'ppt': 'üìì', 'pptx': 'üìì',
                'zip': 'üì¶', 'rar': 'üì¶', '7z': 'üì¶',
                'jpg': 'üñºÔ∏è', 'jpeg': 'üñºÔ∏è', 'png': 'üñºÔ∏è', 'gif': 'üñºÔ∏è',
                'mp3': 'üéµ', 'wav': 'üéµ', 'flac': 'üéµ',
                'mp4': 'üé¨', 'avi': 'üé¨', 'mkv': 'üé¨',
                'js': 'üìú', 'html': 'üåê', 'css': 'üé®',
                'exe': '‚öôÔ∏è', 'msi': '‚öôÔ∏è'
            };
            return icons[ext] || 'üìÑ';
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ü–æ–ª—É—á–∞–µ–º –ø—É—Ç—å –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ URL
            const pathParam = getQueryParam('path');
            if (pathParam) {
                currentPath = pathParam;
            }
            
            updateBreadcrumb();
            loadDirectoryContents();
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" –≤ –±—Ä–∞—É–∑–µ—Ä–µ
            window.addEventListener('popstate', function(event) {
                if (event.state && event.state.path !== undefined) {
                    currentPath = event.state.path;
                    updateBreadcrumb();
                    loadDirectoryContents();
                }
            });
        });
    </script>
</body>
</html>
