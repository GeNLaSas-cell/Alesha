<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alesha File Explorer</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #24292e;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .actions-section {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .action-card {
            background-color: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            flex: 1;
            min-width: 300px;
        }
        .action-form {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        .action-form input, .action-form button {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .action-form button {
            color: white;
            border: none;
            cursor: pointer;
        }
        .btn-primary {
            background-color: #007bff;
        }
        .btn-primary:hover {
            background-color: #0056b3;
        }
        .btn-danger {
            background-color: #dc3545;
        }
        .btn-danger:hover {
            background-color: #c82333;
        }
        .btn-success {
            background-color: #28a745;
        }
        .btn-success:hover {
            background-color: #218838;
        }
        .btn-info {
            background-color: #17a2b8;
        }
        .btn-info:hover {
            background-color: #138496;
        }
        .breadcrumb {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        .breadcrumb-links {
            flex-grow: 1;
        }
        .breadcrumb a {
            color: #007bff;
            text-decoration: none;
        }
        .file-list {
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .file-item {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
        }
        .file-item:last-child {
            border-bottom: none;
        }
        .file-item:hover {
            background-color: #f8f9fa;
        }
        .file-icon {
            margin-right: 10px;
            width: 24px;
            text-align: center;
        }
        .file-name {
            flex-grow: 1;
        }
        .file-size {
            color: #6c757d;
            font-size: 0.9em;
            margin-right: 10px;
        }
        .file-actions {
            display: flex;
            gap: 5px;
        }
        .file-actions button {
            padding: 4px 8px;
            border: 1px solid #ddd;
            border-radius: 3px;
            background-color: #f8f9fa;
            cursor: pointer;
            font-size: 0.8em;
        }
        .file-actions button:hover {
            background-color: #e9ecef;
        }
        .folder {
            font-weight: bold;
            color: #0366d6;
        }
        .file {
            color: #24292e;
        }
        a {
            text-decoration: none;
            color: inherit;
        }
        a:hover {
            text-decoration: underline;
        }
        .loading {
            text-align: center;
            padding: 20px;
            color: #6c757d;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 20px;
            border-radius: 5px;
            width: 300px;
            text-align: center;
        }
        .status-message {
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
            display: none;
        }
        .status-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status-info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .current-path {
            background-color: #f8f9fa;
            padding: 5px 10px;
            border-radius: 3px;
            font-family: monospace;
            margin: 10px 0;
        }
        .confirm-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1001;
        }
        .confirm-content {
            background-color: white;
            margin: 20% auto;
            padding: 20px;
            border-radius: 5px;
            width: 350px;
            text-align: center;
        }
        .confirm-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }
        .copy-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #28a745;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 1002;
            display: none;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìÅ Alesha File Explorer</h1>
        <p>–ü–æ–ª–Ω—ã–π —Ñ–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è GitHub</p>
    </div>

    <div class="actions-section">
        <div class="action-card">
            <h3>üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</h3>
            <div class="action-form">
                <input type="file" id="fileInput">
                <input type="text" id="fileName" placeholder="–ò–º—è —Ñ–∞–π–ª–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
                <button onclick="uploadFile()" class="btn-success">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
            </div>
            <div id="uploadStatus" class="status-message"></div>
        </div>

        <div class="action-card">
            <h3>üìÇ –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É</h3>
            <div class="action-form">
                <input type="text" id="folderName" placeholder="–ò–º—è –ø–∞–ø–∫–∏">
                <button onclick="createFolder()" class="btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
            <div id="folderStatus" class="status-message"></div>
        </div>
    </div>

    <div class="breadcrumb">
        <div class="breadcrumb-links" id="breadcrumb">
            <a href="#" onclick="navigateTo('')">–ì–ª–∞–≤–Ω–∞—è</a>
        </div>
        <div class="current-path">
            –¢–µ–∫—É—â–∏–π –ø—É—Ç—å: <span id="currentPathDisplay">/</span>
        </div>
    </div>

    <div class="file-list" id="fileList">
        <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
    </div>

    <div class="modal" id="authModal">
        <div class="modal-content">
            <h3>üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h3>
            <p>–î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞–º–∏ –Ω—É–∂–µ–Ω GitHub Token</p>
            <input type="password" id="githubToken" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à GitHub Token" style="width: 100%; padding: 8px; margin: 10px 0; border: 1px solid #ddd; border-radius: 4px;">
            <button onclick="saveToken()" style="padding: 8px 16px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <p style="font-size: 0.8em; margin-top: 10px;">
                <a href="https://github.com/settings/tokens" target="_blank">–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω</a> (–Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∞ repo)
            </p>
        </div>
    </div>

    <div class="confirm-modal" id="confirmModal">
        <div class="confirm-content">
            <h3>‚ö†Ô∏è –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</h3>
            <p id="confirmMessage">–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ?</p>
            <div class="confirm-buttons">
                <button onclick="confirmAction(true)" class="btn-danger">–î–∞</button>
                <button onclick="confirmAction(false)" class="btn-primary">–ù–µ—Ç</button>
            </div>
        </div>
    </div>

    <div class="copy-notification" id="copyNotification">
        ‚úÖ –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const OWNER = 'GeNLaSas-cell';
        const REPO = 'Alesha';
        let GITHUB_TOKEN = localStorage.getItem('github_token');
        
        // –¢–µ–∫—É—â–∏–π –ø—É—Ç—å
        let currentPath = '';
        let pendingAction = null;

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏
        function showCopyNotification() {
            const notification = document.getElementById('copyNotification');
            notification.style.display = 'block';
            setTimeout(() => {
                notification.style.display = 'none';
            }, 2000);
        }

        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
        async function copyFileLink(fileUrl) {
            try {
                await navigator.clipboard.writeText(fileUrl);
                showCopyNotification();
            } catch (error) {
                // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                const textArea = document.createElement('textarea');
                textArea.value = fileUrl;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showCopyNotification();
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å —Å–æ–æ–±—â–µ–Ω–∏–µ
        function showStatus(message, type, elementId = 'uploadStatus') {
            const statusElement = document.getElementById(elementId);
            statusElement.textContent = message;
            statusElement.className = 'status-message';
            
            if (type === 'success') {
                statusElement.classList.add('status-success');
            } else if (type === 'error') {
                statusElement.classList.add('status-error');
            } else {
                statusElement.classList.add('status-info');
            }
            
            statusElement.style.display = 'block';
            
            // –ê–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            if (type !== 'info') {
                setTimeout(() => {
                    statusElement.style.display = 'none';
                }, 5000);
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
        function showConfirm(message, actionCallback) {
            document.getElementById('confirmMessage').textContent = message;
            document.getElementById('confirmModal').style.display = 'block';
            pendingAction = actionCallback;
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è
        function confirmAction(confirmed) {
            document.getElementById('confirmModal').style.display = 'none';
            if (confirmed && pendingAction) {
                pendingAction();
            }
            pendingAction = null;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function showAuthModal() {
            document.getElementById('authModal').style.display = 'block';
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω
        function saveToken() {
            const token = document.getElementById('githubToken').value;
            if (token) {
                localStorage.setItem('github_token', token);
                GITHUB_TOKEN = token;
                document.getElementById('authModal').style.display = 'none';
                showStatus('‚úÖ –¢–æ–∫–µ–Ω —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ URL
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function navigateTo(path) {
            currentPath = path;
            updateBreadcrumb();
            updateCurrentPathDisplay();
            loadDirectoryContents();
            // –û–±–Ω–æ–≤–ª—è–µ–º URL –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            const newUrl = window.location.origin + window.location.pathname + (path ? `?path=${encodeURIComponent(path)}` : '');
            window.history.pushState({ path }, '', newUrl);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø—É—Ç–∏
        function updateCurrentPathDisplay() {
            document.getElementById('currentPathDisplay').textContent = currentPath ? '/' + currentPath : '/';
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö–ª–µ–±–Ω—ã—Ö –∫—Ä–æ—à–µ–∫
        function updateBreadcrumb() {
            const breadcrumb = document.getElementById('breadcrumb');
            let html = '<a href="#" onclick="navigateTo(\'\')">–ì–ª–∞–≤–Ω–∞—è</a>';
            
            if (currentPath) {
                const parts = currentPath.split('/').filter(part => part);
                let accumulatedPath = '';
                
                parts.forEach((part, index) => {
                    accumulatedPath += (accumulatedPath ? '/' : '') + part;
                    html += ` / <a href="#" onclick="navigateTo('${accumulatedPath}')">${part}</a>`;
                });
            }
            
            breadcrumb.innerHTML = html;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
        async function loadDirectoryContents() {
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '<div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div>';
            
            try {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º GitHub API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
                const apiUrl = `https://api.github.com/repos/${OWNER}/${REPO}/contents/${currentPath}`;
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏');
                }
                
                const contents = await response.json();
                
                if (contents.length === 0) {
                    fileList.innerHTML = '<div class="file-item">–ü–∞–ø–∫–∞ –ø—É—Å—Ç–∞</div>';
                    return;
                }
                
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º: —Å–Ω–∞—á–∞–ª–∞ –ø–∞–ø–∫–∏, –ø–æ—Ç–æ–º —Ñ–∞–π–ª—ã
                contents.sort((a, b) => {
                    if (a.type === b.type) {
                        return a.name.localeCompare(b.name);
                    }
                    return a.type === 'dir' ? -1 : 1;
                });
                
                let html = '';
                contents.forEach(item => {
                    const isDir = item.type === 'dir';
                    const icon = isDir ? 'üìÅ' : getFileIcon(item.name);
                    const size = isDir ? '' : `<span class="file-size">(${formatFileSize(item.size)})</span>`;
                    const fileUrl = item.download_url;
                    
                    html += `
                        <div class="file-item ${isDir ? 'folder' : 'file'}">
                            <span class="file-icon">${icon}</span>
                            <span class="file-name">
                                <a href="${isDir ? '#' : fileUrl}" ${isDir ? `onclick="navigateTo('${currentPath ? currentPath + '/' : ''}${item.name}')"` : 'target="_blank"'}>
                                    ${item.name}
                                </a>
                            </span>
                            <span class="file-size">${size}</span>
                            <div class="file-actions">
                                ${isDir ? `
                                    <button onclick="showConfirm('–£–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É \\'${item.name}\\'?', () => deleteFolder('${item.path}'))" class="btn-danger" title="–£–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É">üóëÔ∏è</button>
                                ` : `
                                    <button onclick="copyFileLink('${fileUrl}')" class="btn-info" title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É">üìã</button>
                                    <button onclick="showConfirm('–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª \\'${item.name}\\'?', () => deleteFile('${item.path}'))" class="btn-danger" title="–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª">üóëÔ∏è</button>
                                `}
                            </div>
                        </div>
                    `;
                });
                
                fileList.innerHTML = html;
                
            } catch (error) {
                fileList.innerHTML = `<div class="file-item">–û—à–∏–±–∫–∞: ${error.message}</div>`;
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–∫–∏
        async function createFolder() {
            if (!GITHUB_TOKEN) {
                showAuthModal();
                return;
            }

            const folderNameInput = document.getElementById('folderName');
            const folderName = folderNameInput.value.trim();

            if (!folderName) {
                showStatus('‚ùå –í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–∞–ø–∫–∏', 'error', 'folderStatus');
                return;
            }

            const folderPath = currentPath ? `${currentPath}/${folderName}` : folderName;

            showStatus('‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–∫–∏...', 'info', 'folderStatus');

            try {
                // –°–æ–∑–¥–∞–µ–º .gitkeep —Ñ–∞–π–ª –≤–Ω—É—Ç—Ä–∏ –ø–∞–ø–∫–∏ (GitHub –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—É—Å—Ç—ã–µ –ø–∞–ø–∫–∏)
                const response = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/contents/${folderPath}/.gitkeep`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: `Create folder: ${folderName}`,
                        content: btoa('') // –ü—É—Å—Ç–æ–π —Ñ–∞–π–ª
                    })
                });

                if (response.ok) {
                    showStatus('‚úÖ –ü–∞–ø–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!', 'success', 'folderStatus');
                    folderNameInput.value = '';
                    loadDirectoryContents();
                } else {
                    const result = await response.json();
                    throw new Error(result.message || '–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞–ø–∫–∏');
                }
            } catch (error) {
                showStatus(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error', 'folderStatus');
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –ø–∞–ø–∫–∏ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø—É—Å—Ç–∞—è)
        async function deleteFolder(folderPath) {
            if (!GITHUB_TOKEN) {
                showAuthModal();
                return;
            }

            showStatus('‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–ø–∫–∏...', 'info');

            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–ø–∫–∏
                const contentsResponse = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/contents/${folderPath}`, {
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });

                if (!contentsResponse.ok) {
                    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–ø–∫–∏');
                }

                const contents = await contentsResponse.json();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—É—Å—Ç–∞—è –ª–∏ –ø–∞–ø–∫–∞ (—Ç–æ–ª—å–∫–æ .gitkeep –∏–ª–∏ –≤–æ–æ–±—â–µ –ø—É—Å—Ç–∞—è)
                const hasFiles = contents.some(item => item.name !== '.gitkeep');
                
                if (hasFiles) {
                    showStatus('‚ùå –ü–∞–ø–∫–∞ –Ω–µ –ø—É—Å—Ç–∞! –£–¥–∞–ª–∏—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –≤—Å–µ —Ñ–∞–π–ª—ã.', 'error');
                    return;
                }

                // –£–¥–∞–ª—è–µ–º .gitkeep —Ñ–∞–π–ª, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
                const gitkeepFile = contents.find(item => item.name === '.gitkeep');
                if (gitkeepFile) {
                    await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/contents/${folderPath}/.gitkeep`, {
                        method: 'DELETE',
                        headers: {
                            'Authorization': `token ${GITHUB_TOKEN}`,
                            'Accept': 'application/vnd.github.v3+json',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            message: `Delete folder: ${folderPath.split('/').pop()}`,
                            sha: gitkeepFile.sha
                        })
                    });
                }

                showStatus('‚úÖ –ü–∞–ø–∫–∞ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞!', 'success');
                loadDirectoryContents();

            } catch (error) {
                showStatus(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–∞–ø–∫–∏: ${error.message}`, 'error');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –Ω–∞ GitHub
        async function uploadFile() {
            if (!GITHUB_TOKEN) {
                showAuthModal();
                return;
            }

            const fileInput = document.getElementById('fileInput');
            const customFileName = document.getElementById('fileName').value;
            
            if (!fileInput.files[0]) {
                showStatus('‚ùå –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏', 'error');
                return;
            }

            const file = fileInput.files[0];
            const fileName = customFileName || file.name;
            const filePath = currentPath ? `${currentPath}/${fileName}` : fileName;

            showStatus('‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...', 'info');

            try {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º FileReader –¥–ª—è —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    // –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ base64
                    const binaryData = e.target.result;
                    const base64Data = btoa(
                        new Uint8Array(binaryData)
                            .reduce((data, byte) => data + String.fromCharCode(byte), '')
                    );
                    
                    // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–≥—Ä—É–∑–∫–∏
                    uploadToGitHub(filePath, fileName, base64Data);
                };
                
                reader.onerror = function(error) {
                    showStatus('‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞', 'error');
                    console.error('FileReader error:', error);
                };
                
                // –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª –∫–∞–∫ ArrayBuffer
                reader.readAsArrayBuffer(file);
                
            } catch (error) {
                showStatus(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
                console.error('Upload error:', error);
            }
        }

        // –û—Ç–¥–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ GitHub
        async function uploadToGitHub(filePath, fileName, base64Data) {
            try {
                const response = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/contents/${filePath}`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: `Upload ${fileName}`,
                        content: base64Data
                    })
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    showStatus('‚úÖ –§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!', 'success');
                    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                    document.getElementById('fileInput').value = '';
                    document.getElementById('fileName').value = '';
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
                    loadDirectoryContents();
                } else {
                    throw new Error(result.message || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏');
                }
            } catch (error) {
                showStatus(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
                console.error('GitHub API error:', error);
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
        async function deleteFile(filePath) {
            if (!GITHUB_TOKEN) {
                showAuthModal();
                return;
            }

            showStatus('‚è≥ –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞...', 'info');

            try {
                // –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å SHA
                const infoResponse = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/contents/${filePath}`, {
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (!infoResponse.ok) throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ');
                
                const fileInfo = await infoResponse.json();
                
                // –¢–µ–ø–µ—Ä—å —É–¥–∞–ª—è–µ–º —Ñ–∞–π–ª
                const deleteResponse = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/contents/${filePath}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: `Delete ${filePath.split('/').pop()}`,
                        sha: fileInfo.sha
                    })
                });
                
                if (deleteResponse.ok) {
                    showStatus('‚úÖ –§–∞–π–ª —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω!', 'success');
                    loadDirectoryContents();
                } else {
                    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª');
                }
                
            } catch (error) {
                showStatus(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏: ${error.message}`, 'error');
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –¥–ª—è —Ñ–∞–π–ª–∞ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é
        function getFileIcon(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const icons = {
                'txt': 'üìÑ', 'pdf': 'üìï', 'doc': 'üìò', 'docx': 'üìò',
                'xls': 'üìó', 'xlsx': 'üìó', 'ppt': 'üìì', 'pptx': 'üìì',
                'zip': 'üì¶', 'rar': 'üì¶', '7z': 'üì¶',
                'jpg': 'üñºÔ∏è', 'jpeg': 'üñºÔ∏è', 'png': 'üñºÔ∏è', 'gif': 'üñºÔ∏è',
                'mp3': 'üéµ', 'wav': 'üéµ', 'flac': 'üéµ',
                'mp4': 'üé¨', 'avi': 'üé¨', 'mkv': 'üé¨',
                'js': 'üìú', 'html': 'üåê', 'css': 'üé®',
                'exe': '‚öôÔ∏è', 'msi': '‚öôÔ∏è'
            };
            return icons[ext] || 'üìÑ';
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ü–æ–ª—É—á–∞–µ–º –ø—É—Ç—å –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ URL
            const pathParam = getQueryParam('path');
            if (pathParam) {
                currentPath = pathParam;
            }
            
            updateBreadcrumb();
            updateCurrentPathDisplay();
            loadDirectoryContents();
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" –≤ –±—Ä–∞—É–∑–µ—Ä–µ
            window.addEventListener('popstate', function(event) {
                if (event.state && event.state.path !== undefined) {
                    currentPath = event.state.path;
                    updateBreadcrumb();
                    updateCurrentPathDisplay();
                    loadDirectoryContents();
                }
            });
        });
    </script>
</body>
</html>
